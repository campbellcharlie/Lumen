# Lumen

**A browser-like Markdown document renderer for modern terminals**

Lumen renders Markdown documents with rich layout, theming, and smooth scrolling—directly in your terminal. Built specifically for viewing markdown files generated by AI coding tools like Claude, Gemini, and Codex.

Unlike traditional Markdown viewers that style text with ANSI codes, Lumen treats rendering as a proper layout problem: Markdown → IR → Layout → Render. This approach handles complex nested structures, tables, and deeply nested lists that AI tools commonly generate.

---

## Installation

```bash
# Build the project
cargo build --release

# The binary will be at:
./target/release/lumen
```

## Usage

```bash
# View a single file
lumen README.md

# View AI-generated responses (use Tab to switch between them)
lumen claude_response.md gemini_output.md codex_analysis.md

# Use a different theme
lumen README.md neon

# View all AI outputs in a directory
lumen *.md
```

### Available Themes

**Built-in themes:**
- `docs` — Clean, documentation-focused (default)
- `neon` — Vibrant, modern with bright colors
- `minimal` — Low visual noise, ASCII fallbacks
- `dracula` — Dark purple with vibrant accents
- `monokai` — Classic Sublime Text inspired
- `solarized` — Low-contrast, easy on the eyes
- `gruvbox` — Retro groove with warm colors
- `nord` — Arctic, blue-ish coldness
- `tokyo-night` — Modern dark Tokyo-inspired
- `catppuccin` — Soothing pastel colors

---

## Keyboard Shortcuts

### Navigation
| Key | Action |
|-----|--------|
| `j` / `↓` | Scroll down one line |
| `k` / `↑` | Scroll up one line |
| `d` | Scroll down half page |
| `u` | Scroll up half page |
| `Space` / `PageDown` | Scroll down one page |
| `PageUp` | Scroll up one page |
| `g` / `Home` | Go to top of document |
| `G` / `End` | Go to bottom of document |

### Links & Navigation
| Key | Action |
|-----|--------|
| `a` | Cycle through links (for table of contents navigation) |
| `Enter` | Follow selected link (jump to anchor) |

### File Management
| Key | Action |
|-----|--------|
| `Tab` | Switch to next file (when multiple files are open) |
| `Shift+Tab` | Switch to previous file |
| `f` | Toggle file sidebar visibility (when multiple files are open) |

### General
| Key | Action |
|-----|--------|
| `q` / `Esc` | Quit |

---

## Why Lumen?

AI coding tools (Claude, Gemini, Codex) generate complex markdown with deep nesting, large tables, and mixed content that traditional viewers struggle with:

- **Deep nested lists**: AI responses often have 4+ levels of nesting - Lumen handles them correctly
- **Large tables**: Data comparisons and feature matrices render with accurate borders
- **Mixed content**: Code blocks, tables, and lists intermixed without layout issues
- **Navigation**: Jump through table of contents links, cycle between multiple response files
- **Readable**: Proper spacing, wrapping, and visual hierarchy unlike raw terminal markdown

---

## Features

### Markdown Support
- Full GFM (GitHub Flavored Markdown) support
- Headings, paragraphs, lists (including deep nesting 4+ levels)
- Tables with accurate border rendering
- Code blocks, task lists, strikethrough
- Links, images, blockquotes with nesting
- Proper tight list handling for correct structure

### Theming
- 10 built-in themes: Docs (default), Neon, Minimal, Dracula, Monokai, Solarized, Gruvbox, Nord, Tokyo Night, Catppuccin
- Color palettes with RGB/ANSI fallbacks
- Multiple border styles: Single, Double, Rounded, Heavy, ASCII
- Typography and spacing configuration via YAML

### Layout & Rendering
- Vertical flow layout with proper margins
- Smart text wrapping (word-boundary + long-word breaking)
- Table layout with column distribution
- Rich colors (24-bit RGB, 256-color, 16-color)
- Box-drawing characters for borders
- Double-buffered rendering for smooth scrolling

### Interactive Navigation
- Keyboard-driven navigation (vim-style bindings)
- Link cycling and anchor jumping for table of contents
- Visual link highlighting for selected links
- Multi-file support with tab switching
- Status bar with position indicator and file name
- Hit regions for interactive elements

---

## Architecture

Lumen uses a multi-stage rendering pipeline:

```
Markdown → IR (pulldown-cmark) → Theme + Layout → Terminal Renderer (Ratatui)
```

**Key design decisions:**
- Stable IR prevents downstream churn when parser changes
- Token-based theming (no CSS selectors, just element-type styling)
- Two-phase layout: measure intrinsic sizes, then assign positions
- Character-grid coordinates for natural terminal rendering

---

## Project Structure

```
Lumen/
├── src/
│   ├── ir/           # Intermediate representation
│   ├── parser/       # Markdown → IR
│   ├── theme/        # Theming system
│   ├── layout/       # Layout engine
│   ├── render/       # Terminal renderer
│   ├── lib.rs        # Public API
│   └── main.rs       # Interactive viewer binary
├── themes/           # YAML theme files
└── examples/         # Demo programs
```

---

## Dependencies

- [pulldown-cmark](https://github.com/pulldown-cmark/pulldown-cmark) — Fast, spec-compliant Markdown parser
- [Ratatui](https://github.com/ratatui/ratatui) — Terminal UI framework
- [crossterm](https://github.com/crossterm-rs/crossterm) — Cross-platform terminal manipulation

---

## Development

### Running Tests

```bash
cargo test
```

### Examples

```bash
# Theme demo
cargo run --example themes

# Layout demo
cargo run --example layout
```

---

## License

MIT
